# 자바 ORM 표준 JPA 프로그래밍  
; https://book.naver.com/bookdb/book_detail.nhn?bid=9252528  

---  

## H2 데이터베이스 설치  

> 다운로드  

http://www.h2database.com 에서 All Platforms or Platform-Independent Zip  

> bin/h2.sh (bin/h2.bat) 실행  

---  

## 정리  

### 3. 영속성 관리

- 엔티티 매니저는 엔티티 매니저 팩토리에서 생성 됨  
(J2SE 환경에서는 엔티티 매니저를 만들면 그 내부에 영속성 컨텍스트도 함께 만들어 짐)  
- 영속성 컨텍스트는 애플리케이션과 데이터베이스 사이에서 객체를 보관하는 가상의 데이터베이스 역할을 함  
=> 1차 캐시, 동일성 보장, 트랜잭션을 지원하는 쓰기 지연, 변경 감지, 지연 로딩 기능을 사용할 수 있음
- 영속성 컨텍스트에 저장한 엔티티는 플러시 시점에 데이터베이스에 반영  
(일반적으로 트랜잭션을 커밋할 때 영속성 컨텍스트가 플러시 됨)  
- 영속성 컨텍스트가 관리하는 엔티티를 **영속 상태** 의 엔티티라고 함. 더 이상 관리하지 못하면  
**준영속 상태의 엔티티** 라 함. 준영속 상태의 엔티티는 영속성 컨텍스트가 제공하는 위의 기능들을  
사용할 수 없음  

### 4. 엔티티 매핑  

- @Entity @Table을 통한 객체와 테이블 매핑
- 키 매핑 전략
  - 직접 할당
  - IDENTITY : 기본 키 생성을 데이터베이스에 위임
  - SEQUENCE : 데이터베이스 시퀀스를 사용해 기본 키를 할당
  - TABLE : 키 생성 테이블을 사용
  - AUTO : 선택한 데이터베이스 방언에 따라 IDENTITY, SEQUENCE, TABLE 전략 중 하나 사용
- 필드와 컬럼 매핑
  - @Column : 컬럼을 매핑
  - @Enumerated : 자바의 enum 타입을 매핑
  - @Temporal : 날짜 타입을 매핑
  - @Lob : BLOB, CLOB 타입을 매핑
  - @Transient : 특정 필드를 데이터베이스에 매핑X
  - @Access : JPA가 엔티티에 접근하는 방식을 지정  

### 5. 연관관계 매핑 기초  

- 방향(Direction) : [단방향, 양방향] 방향은 객체에만 존재, 테이블은 항상 양방향  
- 다중성(Multiplicity) : [다대일(N:1), 일대다(1:N), 일대일(1:1), 다대다(N:M)]
- 연관관계의 주인(Owner) : 객체를 양방향 연관관계로 만들면 주인을 정해야 함  
=>  
- 단방향 매핑만으로 테이블과 객체의 연관관계 매핑은 이미 완료
- 단방향을 양방향으로 만들면 반대방향으로 객체 그래프 탐색 기능이 추가
- 양방향 연관관계를 매핑하려면 객체에서 양쪽 방향을 모두 관리해야 함  
